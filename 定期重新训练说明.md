# 黄金价格预测模型定期重新训练功能使用说明

## 功能概述

为了保持黄金价格预测模型的准确性，我们已经实现了一个定期重新训练系统。该系统会定期检查现有模型的训练日期，当达到设定的重新训练周期时（默认为90天），系统会自动获取最新数据并重新训练模型。

## 关键特性

1. **智能重新训练决策**：系统会自动检查上次训练日期，只有在必要时才重新训练
2. **模型版本管理**：保存带时间戳的模型文件和元数据，同时维护"最新模型"链接
3. **性能指标跟踪**：记录每次训练的模型性能指标，便于比较
4. **数据范围记录**：保存每个模型训练使用的数据范围信息
5. **自动清理**：自动清理旧模型文件，只保留最新的几个版本

## 使用方法

### 手动运行检查

您可以随时手动运行以下命令，系统会自动判断是否需要重新训练：

```bash
python gold.py
```

### 强制重新训练

如果您希望立即重新训练模型，不管上次训练时间如何，可以使用：

```bash
python gold.py --force-retrain
```

### 调整重新训练周期

默认的重新训练周期是90天。您可以根据市场变化速度调整这个周期：

```bash
# 设置为180天（半年）重新训练一次
python gold.py --retrain-period 180

# 设置为30天（每月）重新训练一次
python gold.py --retrain-period 30
```

### 设置自动定期运行

为了实现真正的自动化，您可以使用系统的定时任务功能设置定期运行：

1. 首先确保自动重新训练脚本有执行权限：

```bash
chmod +x auto_retrain.sh
```

2. 设置crontab定期任务（以下示例为每周一早上9点运行）：

```bash
# 编辑当前用户的crontab
crontab -e

# 添加以下行（每周一早上9点运行）
0 9 * * 1 /完整路径/到您的项目/auto_retrain.sh
```

您也可以根据需要调整定时计划：

- 每天运行一次：`0 9 * * *`
- 每月1日运行：`0 9 1 * *`
- 每季度第一天运行：`0 9 1 1,4,7,10 *`

## 查看模型状态

您可以通过查看最新模型的元数据文件了解当前模型状态：

```bash
cat models/latest_model_metadata.json
```

这将显示：
- 上次训练日期
- 下次计划训练日期
- 模型性能指标
- 训练数据范围

## 重新训练日志

系统会在`retraining.log`文件中记录每次重新训练检查的结果，您可以查看此文件了解历史记录：

```bash
cat retraining.log
```

## 最佳实践建议

1. **定期检查日志**：即使设置了自动重新训练，也建议定期检查日志以确保系统正常运行
2. **调整重新训练周期**：根据模型性能和市场变化速度调整重新训练周期
   - 黄金市场相对稳定：可以考虑使用更长的周期（90-180天）
   - 市场波动较大：可以缩短重新训练周期（30-60天）
3. **监控模型性能**：当您发现模型性能下降时，可以手动触发重新训练
4. **数据源变化**：如果您更改了数据源或特征工程方法，应立即进行强制重新训练

## 故障排除

如果遇到问题，请检查：

1. **日志文件**：查看`retraining.log`以了解错误信息
2. **模型文件**：确保`models`目录存在且有写入权限
3. **虚拟环境**：确保`gold-env`虚拟环境正确设置
4. **crontab设置**：如果自动运行失败，检查crontab配置和路径

## 总结

通过定期重新训练功能，您的黄金价格预测模型将始终保持最新状态，提高预测准确性。默认的90天重新训练周期平衡了历史数据的稳定性和新市场条件的适应性，是金融市场预测的良好实践。 